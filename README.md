# Генератор тестовых COVID-19 QR-кодов

![](demo.png)

Генерируемые тестовые QR-коды подходят для проверки только на тестовом стенде. Данное приложение не
генерирует рабочие QR-коды. Созданными QR-кодами пользоваться запрещено!

## Настройка

Для запуска демо-стенда требуются следующие переменные окружения:

- `FLASK_APP` — указывается местоположение скрипта сервера, необходимо указать: `app/main`
- `FLASK_ENV` — устанавливается значение окружения, требуется для работы в среде разработки, указывается `development`,
по умолчанию ставится `production`.
- `FLASK_DEBUG` — для включения отладочного режима необходимо включить, указав `1`.
- `REDIS_URL` — указывается полный адрес подключения к Redis, например: `redis://localhost:6379/0`

### Redis

Для хранения временных данных используется Redis. Все временные данные сохраняются на срок от 10 минут до 1 часа.

### Суперпользователи

По умолчанию задан пользователь `admin` с паролем `password`. Для создания собственных пользователей 
необходимо использовать следующие переменные окружения:

- `ADMIN_USER` — кол-во суперпользователей
- `USER_<N>_USERNAME` — логин суперпользователя
- `USER_<N>_PASSWORD` — пароль суперпользователя
- `USER_<N>_FIRST_NAME` — имя суперпользователя
- `USER_<N>_LAST_NAME` — фамилия суперпользователя
- `USER_<N>_SECOND_NAME` — отчество суперпользователя
- `USER_<N>_B_DAY` — день рождения суперпользователя
- `USER_<N>_SERIES` — первые 2 цифры серии паспорта суперпользователя
- `USER_<N>_NUMBER` — последние 3 цифры номера паспорта суперпользователя

Где `<N>` — это цифры от 0 до указанного кол-ва суперпользователей в переменной `ADMIN_USER`, 0 — это 1-ый пользователь.

## Запуск

Запустить проект можно несколькими способами:

- **Без использования Docker** — подойдёт для локальной разработки (не рекомендуется).
- **С частичным использованием Docker** — рекомендуемый способ для локальной разработки.
- **Полностью используя Docker** — подойдёт для запуска в Интернете, для более глубокого тестирования.

### Без использования Docker

Для данного запуска необходимо предварительно позаботиться о предварительно запущенном сервере Redis.

Укажите полный адрес сервера Redis в переменной окружения `REDIS_URL`.

Создайте виртуальное окружение Python 3.9 командой:

```shell
$ python3 -m venv venv
```

Активируйте виртуальное окружение:

```shell
$ source ./venv/bin/active
```

Обновите пакетный менеджер pip до последней версии:

```shell
$ pip insttall --upgrade pip
```

Установите зависимые пакеты:

```shell
$ pip install -r requirements.txt
```

Запустите сервер

```shell
$ flask run
```

### С частичным использованием Docker

Этот способ от предыдущего отличается только тем, что Redis можно запустить воспользовавшись Docker. 
Redis с помощью Docker можно запустить 2 способами:

1. С использованием Docker Compose (рекомендуется).
2. Без использования Docker Compose.

Первый вариант делается командой:

```shell
$ docker-compose up redis -d 
```

Второй вариант:

```shell
$ docker run --name redis -d redis -p 6379:6379
```

Далее необходимо выполнить все шаги описанные в предыдущем варианте запуска.

### Полностью используя Docker

Этот способ самый лёгкий для запуска проекта, но требуется заранее установленного Docker и docker-compose.

Для запуска проекта выполните команду:

```shell
$ docker-compose up -d
```

## Эксплуатация

Для формирования QR-кода с тестовыми данными перейдите по ссылке: <http://localhost:5000/qr-gen> и авторизуйтесь
под суперпользователем.

Введите тестовые данные и нажмите кнопку «**Создать тестовый QR-код**». Справа появится созданные QR-код с тестовыми
данными. Можно перейти по нему воспользовавшись любым QR сканером.

**ВНИМАНИЕ!** Для тестирования с нескольких устройств необходимо запускать сервис либо на действующем домене, 
либо полностью используя Docker, при этом вместо `localhost` в адресе надо будет указать IP-адрес вашей машины внутри
локальной сети.
